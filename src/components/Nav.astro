---
const { currentPath = "/" } = Astro.props;

const navItems = [
  { label: "Home", href: "/" },
  {
    label: "Profile",
    children: [
      { label: "Poet & Writer", href: "/profile/poet-and-writer" },
      { label: "Lyricist", href: "/profile/lyricist" },
      { label: "Professional career", href: "/profile/professional-career" }
    ]
  },
  { label: "Published Books", href: "/books" },
  { label: "Achievements", href: "/achievements" },
  { label: "Critics / Endorsement", href: "/critics" },
  { label: "Press Clippings", href: "/press" },
  { label: "Gallery", href: "/gallery" },
  { label: "Contact", href: "/contact" },
  { label: "Blog", href: "https://gangeshwarsingh.blogspot.com", external: true }
];

const isActive = (href: string) => currentPath === href || (href !== "/" && currentPath.startsWith(href));
---

<nav class="bg-white/90 sticky top-0 z-50 backdrop-blur shadow-sm border-b border-slate-200/80">
  <div class="section-shell">
    <div class="flex items-center justify-between py-4">
      <a class="flex items-center gap-3" href="/">
        <div class="h-10 w-10 rounded-full bg-indigo-600 text-white grid place-items-center font-semibold shadow-md shadow-indigo-200">
          GS
        </div>
        <div>
          <p class="text-xs uppercase tracking-[0.2em] text-slate-500">Poet & Writer</p>
          <p class="text-lg font-semibold text-slate-900">Gangeshwar Singh</p>
        </div>
      </a>
      <details class="md:hidden">
        <summary class="flex items-center gap-2 px-3 py-2 rounded-full border border-slate-200 bg-white text-sm font-semibold cursor-pointer">
          Menu
          <span aria-hidden="true">▾</span>
        </summary>
        <div class="mt-3 card p-3 space-y-2">
          {navItems.map((item) => (
            item.children ? (
              <details class="rounded-lg border border-slate-200/80" open>
                <summary class="px-3 py-2 font-semibold text-slate-800 cursor-pointer flex items-center justify-between">
                  {item.label}
                  <span aria-hidden="true">▾</span>
                </summary>
                <div class="flex flex-col">
                  {item.children.map((child) => (
                    <a href={child.href} class={`px-3 py-2 text-sm rounded-md hover:bg-indigo-50 ${isActive(child.href) ? "bg-indigo-100 text-indigo-800" : "text-slate-700"}`}>
                      {child.label}
                    </a>
                  ))}
                </div>
              </details>
            ) : (
              <a href={item.href} class={`block px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-50 ${isActive(item.href) ? "bg-indigo-100 text-indigo-800" : "text-slate-700"}`} target={item.external ? "_blank" : undefined} rel={item.external ? "noreferrer" : undefined}>
                {item.label}
              </a>
            )
          ))}
        </div>
      </details>
      <div class="hidden md:flex items-center gap-1">
        {navItems.map((item) =>
          item.children ? (
            <div class="relative group" >
              <button class="px-4 py-2 text-sm font-semibold text-slate-800 rounded-full hover:bg-indigo-50">
                {item.label}
              </button>
              <div class="absolute right-0 mt-2 w-60 card p-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible group-focus-within:opacity-100 group-focus-within:visible transition pointer-events-auto">
                {item.children.map((child) => (
                  <a href={child.href} class={`block px-3 py-2 rounded-lg text-sm hover:bg-indigo-50 ${isActive(child.href) ? "bg-indigo-100 text-indigo-800" : "text-slate-700"}`}>
                    {child.label}
                  </a>
                ))}
              </div>
            </div>
          ) : (
            <a href={item.href} class={`px-4 py-2 text-sm font-semibold rounded-full hover:bg-indigo-50 ${isActive(item.href) ? "bg-indigo-100 text-indigo-800" : "text-slate-700"}`} target={item.external ? "_blank" : undefined} rel={item.external ? "noreferrer" : undefined}>
              {item.label}
            </a>
          )
        )}
      </div>
    </div>
  </div>
</nav>
